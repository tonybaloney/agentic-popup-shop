version: '3.8'

services:
  mcp-supplier-server:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: github-shop-mcp-supplier
    volumes:
      # Mount the database directory
      - /workspace/data:/app/data:ro
    environment:
      - PYTHONPATH=/app/mcp:/app/shared/src
      - PYTHONUNBUFFERED=1
      - MCP_SERVER_NAME=supplier
    ports:
      # Optional: expose ports if using HTTP transport
      - "8002:8002"
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "python", "-c", "import sys; sys.exit(0)"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    networks:
      - mcp-network

  mcp-finance-server:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: github-shop-mcp-finance
    volumes:
      # Mount the database directory
      - /workspace/data:/app/data:ro
    environment:
      - PYTHONPATH=/app/mcp:/app/shared/src
      - PYTHONUNBUFFERED=1
      - MCP_SERVER_NAME=finance
    command: ["uv", "run", "python", "-m", "github_shop_mcp.finance_server"]
    ports:
      # Optional: expose ports if using HTTP transport
      - "8003:8003"
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "python", "-c", "import sys; sys.exit(0)"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    networks:
      - mcp-network

networks:
  mcp-network:
    driver: bridge